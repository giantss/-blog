<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Redux for react native æŒ‡å—(æŒç»­æ›´æ–°)</title>
      <link href="/blog/2018/09/27/Redux-for-react-native-%E6%8C%87%E5%8D%97-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0/"/>
      <url>/blog/2018/09/27/Redux-for-react-native-%E6%8C%87%E5%8D%97-%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¦‚æœè¦çœ‹ç†è®ºçš„ç«¥é‹ç‚¹å‡»è¿™é‡Œ <a href="https://cn.redux.js.org/" target="_blank" rel="noopener">reduxä¸­æ–‡æ–‡æ¡£</a> æˆ–è€… <a href="https://redux.js.org/" target="_blank" rel="noopener">reduxå®˜æ–¹æ–‡æ¡£</a> ï¼Œæœ¬æ–‡ä¸ä¼šå¤ªåˆ»æ„å»ä»‹ç»å¤§ç¯‡å¹…çš„ç†è®ºï¼Œæœ¬æ–‡ä¸åšæ¡†æ¶ä¹‹é—´çš„å¯¹æ¯”ï¼Œåªç»™æƒ³å­¦<code>redux</code>çš„ç«¥é‹æä¾›å®è´¨çš„ã€é«˜æ•ˆçš„ã€æ˜“ç†è§£çš„å­¦ä¹ å‚è€ƒèµ„æºï¼Œåˆ†äº«è‡ªå·±åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­çš„å¾—åˆ°ï¼ˆæ–‡åæœ‰å½©è›‹ ğŸ˜„ï¼‰ã€‚</p><p>è€è§„çŸ©å…ˆä¸Šå›¾ï¼š<br><img src="https://user-gold-cdn.xitu.io/2018/9/27/16618756337e963c?w=270&amp;h=480&amp;f=gif&amp;s=226268" alt="æ•ˆæœå›¾"><br>çœ‹è¿‡<a href="https://codesandbox.io/s/github/reactjs/redux/tree/master/examples/todos" target="_blank" rel="noopener">å®˜æ–¹Todos demo</a>çš„ç«¥é‹å¯èƒ½ä¼šæœ‰ç‚¹ç†Ÿæ‚‰ä¸Šå›¾çš„æ“ä½œï¼Œæ²¡é”™ï¼Œè¿™å°±æ˜¯å®ƒçš„<code>react native</code>ç‰ˆã€‚<br><a id="more"></a></p><h1 id="ä¸ºä»€ä¹ˆæˆ‘è¦å†™è¿™ä¸ªdemo"><a href="#ä¸ºä»€ä¹ˆæˆ‘è¦å†™è¿™ä¸ªdemo" class="headerlink" title="ä¸ºä»€ä¹ˆæˆ‘è¦å†™è¿™ä¸ªdemo"></a>ä¸ºä»€ä¹ˆæˆ‘è¦å†™è¿™ä¸ªdemo</h1><p>æœ‰çš„ç«¥é‹å¯èƒ½ä¼šæœ‰ç–‘é—®<br>é—®ï¼šå®˜æ–¹ä¸æ˜¯<code>Todos</code>demoå—ï¼Ÿä¸ºä»€ä¹ˆè¿˜è¦å†™è¿™ä¸ªdemoï¼Ÿ<br>ç­”ï¼šå®˜æ–¹çš„demoéƒ½æ˜¯<code>react</code>çš„ï¼Œè€Œå¹¶é<code>react native</code>çš„ã€‚æˆ‘ä¹Ÿæ‰¾è¿‡å¾ˆå¤šå…³äºä»‹ç»reduxçš„æ–‡ç« ï¼Œä½†æˆ‘å‘ç°æ‰¾åˆ°çš„èµ„æ–™è¦ä¹ˆå¤ªåŸºç¡€ã€è¦ä¹ˆä»‹ç»ä¸å…¨é¢ã€æä¾›çš„demoä¸‹è½½æ— æ³•ä½¿ç”¨ç­‰ç­‰å„ç§é—®é¢˜ï¼Œè¿«ä½¿æˆ‘æœ‰äº†è‡ªå·±åŠ¨æ‰‹é€ è½®çš„å†²åŠ¨ï¼Œè€Œä¸”è¿™ä¸ªdemoå¹¶éåªæ˜¯ä»‹ç»å…³äºreduxçš„åŸºç¡€çš„ä¸œè¥¿ï¼Œæœ‰ç©ºæˆ‘è¿˜æ²¡é™†ç»­æ›´æ–°åœ¨ä½¿ç”¨<code>redux</code>è¿‡ç¨‹ä¸­çš„å¾—åˆ°ï¼Œå¸Œæœ›å¤§å®¶é¼“åŠ±æ”¯æŒã€‚</p><h1 id="demoé‡‡çš„ä»£ç è§„èŒƒ"><a href="#demoé‡‡çš„ä»£ç è§„èŒƒ" class="headerlink" title="demoé‡‡çš„ä»£ç è§„èŒƒ"></a>demoé‡‡çš„ä»£ç è§„èŒƒ</h1><p>é€šå¸¸ä¸€ä¸ªå¤§é¡¹ç›®åˆ°åæœŸæ˜¯éœ€è¦å¾ˆå¤šå¼€å‘è€…å‚ä¸çš„ï¼Œå¦‚æœæ¯ä¸ªå¼€å‘è€…éƒ½ä½¿ç”¨è‡ªå·±çš„ä¸€å¥—ä»£ç è§„èŒƒåšäº‹æƒ…ï¼Œè¿™æ ·å¸¦æ¥çš„åæœå°±æ˜¯ï¼šåæœŸçš„ä»£ç ç®¡ç†å·¥ä½œå¸¦æ¥éå¸¸å¤§çš„éº»çƒ¦ï¼Œæµªè´¹æ›´å¤šçš„æ—¶é—´å»é‡æ„ï¼Œè€Œä¸”ä¹Ÿä¼šè®©æ–°äººçœ‹ä»£ç æ—¶ç†è§£èŠ±æ›´å¤šçš„æ—¶é—´ï¼Œè¿˜å®¹æ˜“æŠŠåˆ«äººå¸¦æ²Ÿé‡Œå»ï¼Œæ‰€ä»¥ä¸€ä¸ªå¤§å‹é¡¹ç›®æœ€åˆæ„å»ºæ¶æ„çš„æ—¶å€™å°±å¿…é¡»è¦éµå®ˆä¸€äº›è§„èŒƒã€‚<br>é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆèƒ½æ•²å‡ºæ¸…çˆ½è€Œåˆä¼˜é›…çš„ä»£ç å‘¢ï¼Ÿåˆå¦‚ä½•æ£€æŸ¥æˆ‘ä»¬ä»£ç è´¨é‡åˆæ ¼å‘¢ï¼Ÿ<br>æˆ‘åœ¨è¿™é‡ŒæåŠ›æ¨èéµå®ˆ<a href="https://github.com/airbnb/javascript" target="_blank" rel="noopener">airbnb/javascript</a>çš„è§„èŒƒå’Œä½¿ç”¨<a href="https://github.com/eslint/eslint" target="_blank" rel="noopener">eslint</a>æ¥æ£€æŸ¥è‡ªå·±ä»£ç çš„ä»£ç è´¨é‡ï¼ˆæ˜¯å¦éµå®ˆäº†è§„èŒƒï¼‰ï¼Œå› ä¸ºå®ƒä»¬å·²ç»å¾—åˆ°äº†å¾ˆå¤šå…¬å¸å’Œå¼€å‘è€…çš„è®¤å¯ã€‚ï¼ˆè¿™é‡Œè¿‡å¤šçš„ä»‹ç»<code>airbnb</code> <code>eslint</code>ï¼Œæœ¬æ–‡åªæä¾›æ€è·¯ï¼Œæƒ³äº†è§£æ›´å¤šè‡ªè¡Œæœç´¢ï¼‰<br>åœ¨æ²¡æœ‰ä½¿ç”¨ä»£ç è§„èŒƒå‰æˆ‘ä»¬å¯èƒ½ç”¨å„è‡ªçš„é£æ ¼å†™äº†å¾ˆå¤šå¹´çš„ä»£ç äº†ï¼Œçªç„¶è¦é€‚åº”è¿™å¥—è§„èŒƒå¯èƒ½éå¸¸ä¸é€‚åº”ï¼Œæ²¡å…³ç³»ï¼Œå¤šæ•²å¤šç»ƒä¹ ï¼Œæ—¶é—´é•¿äº†å°±ä¹ æƒ¯äº†ï¼Œè°è¿˜æ²¡æœ‰ä¸€ä¸ªè¿‡ç¨‹ï¼Œè¿‡ç¨‹æ˜¯ç—›è‹¦çš„ï¼Œä½†ç—›è‹¦è¿‡åä¼šç»™ä½ å¸¦æ¥è´¨çš„å‡åï¼Œè‡ªå·±æ…¢æ…¢é¢†æ‚Ÿä½“ä¼šã€‚<br>å¦‚æœè¿˜æ˜¯åšæŒæˆ‘è¡Œæˆ‘ç´ ï¼Œé‚£æˆ‘ä¹Ÿæ²¡åŠæ³•çš„ï¼Œæˆ‘åªèƒ½è¯´å¥½çš„ä¸œè¥¿æ˜¯ä¼šè¢«ä¸–ç•Œæ‰€æ¥å—ï¼Œå·®çš„ä¸œè¥¿æœ€ç»ˆæ˜¯è¦è¢«æ·˜æ±°çš„ï¼Œæ‰€ä»¥åšä¸ºä¸€ä¸ªåˆæ ¼çš„ç¨‹åºå‘˜ï¼ˆç‰¹åˆ«æ˜¯å‰ç«¯ç¨‹åºå‘˜ï¼‰è¦æ‹¥æŠ±å˜åŒ–ï¼Œå› ä¸ºå®ƒä¼šä½¿ä½ å˜å¾—æ›´åŠ çš„ä¼˜ç§€ï¼Œå¾—åˆ°å¤§ä¼—çš„è®¤å¯ã€‚é™¤éä½ ä¸æ„¿æ„è®©è‡ªå·±å˜å¾—æ›´ä¼˜ç§€ã€‚ï¼ˆæˆ‘å›çœ‹å‡ å¹´å‰æˆ‘å†™çš„ä»£ç ï¼Œåªèƒ½ç”¨ä¸€å¨ä¸€å¨çš„æ¥å½¢å®¹ ï¼Œä¸çŸ¥é“ä½ ä»¬æ˜¯å¦ä¹Ÿæœ‰è¿™ç§æ„Ÿè„šå‘¢ï¼ŸğŸ˜ï¼‰</p><h1 id="reduxèƒ½å¸®æˆ‘ä»¬åšä»€ä¹ˆ"><a href="#reduxèƒ½å¸®æˆ‘ä»¬åšä»€ä¹ˆ" class="headerlink" title="reduxèƒ½å¸®æˆ‘ä»¬åšä»€ä¹ˆ"></a>reduxèƒ½å¸®æˆ‘ä»¬åšä»€ä¹ˆ</h1><p>ä¸¤å¼ å›¾ç¤ºæ„ï¼š<br><img src="https://user-gold-cdn.xitu.io/2018/9/27/166187563364a099?w=600&amp;h=399&amp;f=png&amp;s=428741" alt="æœªä½¿ç”¨reduxçš„å¤§å‹react nativeé¡¹ç›®"><br><img src="https://user-gold-cdn.xitu.io/2018/9/27/166187563375203d?w=481&amp;h=586&amp;f=png&amp;s=400514" alt="ä½¿ç”¨reduxåçš„å¤§å‹react nativeé¡¹ç›®"></p><h1 id="reduxç‰¹æ€§"><a href="#reduxç‰¹æ€§" class="headerlink" title="reduxç‰¹æ€§"></a>reduxç‰¹æ€§</h1><ul><li><p><strong>å•ä¸€æ•°æ®æºï¼š æ•´ä¸ªåº”ç”¨çš„ <a href="https://cn.redux.js.org/docs/Glossary.html#state" target="_blank" rel="noopener">state</a> è¢«å‚¨å­˜åœ¨ä¸€æ£µ object tree ä¸­ï¼Œå¹¶ä¸”è¿™ä¸ª object tree åªå­˜åœ¨äºå”¯ä¸€ä¸€ä¸ª <a href="https://cn.redux.js.org/docs/Glossary.html#store" target="_blank" rel="noopener">store</a> ä¸­ã€‚</strong></p></li><li><p><strong>State æ˜¯åªè¯»çš„ï¼šå”¯ä¸€æ”¹å˜ state çš„æ–¹æ³•å°±æ˜¯è§¦å‘ <a href="https://cn.redux.js.org/docs/Glossary.html#action" target="_blank" rel="noopener">action</a>ï¼Œaction æ˜¯ä¸€ä¸ªç”¨äºæè¿°å·²å‘ç”Ÿäº‹ä»¶çš„æ™®é€šå¯¹è±¡ã€‚</strong></p></li><li><p><strong>ä½¿ç”¨çº¯å‡½æ•°æ¥æ‰§è¡Œä¿®æ”¹ï¼šä¸ºäº†æè¿° action å¦‚ä½•æ”¹å˜ state tree ï¼Œä½ éœ€è¦ç¼–å†™ <a href="https://cn.redux.js.org/docs/Glossary.html#reducer" target="_blank" rel="noopener">reducers</a>ã€‚</strong></p></li><li><p><strong>é¢„è§æ€§ï¼šæ‰€æœ‰çš„ç”¨æˆ·çš„è¡Œä¸ºéƒ½æ˜¯ä½ æå‰å®šä¹‰å¥½çš„ã€‚</strong></p></li><li><strong>ç»Ÿä¸€ç®¡ç†stateï¼šæ‰€æœ‰çš„çŠ¶æ€éƒ½åœ¨ä¸€ä¸ªstoreä¸­åˆ†é…ç®¡ç†ã€‚</strong></li></ul><h1 id="å“ªäº›å¼€å‘è€…å’Œé¡¹ç›®é€‚åˆç”¨redux"><a href="#å“ªäº›å¼€å‘è€…å’Œé¡¹ç›®é€‚åˆç”¨redux" class="headerlink" title="å“ªäº›å¼€å‘è€…å’Œé¡¹ç›®é€‚åˆç”¨redux"></a>å“ªäº›å¼€å‘è€…å’Œé¡¹ç›®é€‚åˆç”¨redux</h1><p>è¿™é‡Œåªé’ˆå¯¹<code>react native</code>å¼€å‘è€Œè¨€ï¼š</p><ul><li>åˆçº§ï¼šåˆšæ¥è§¦<code>react native</code>æˆ‘éå¸¸ä¸å»ºè®®å»ä½¿ç”¨ï¼Œå› ä¸ºä½ è¿˜ä¸çŸ¥é“æ€ä¹ˆç”¨å®ƒï¼Œå»ºè®®å…ˆè¾¾åˆ°ä¸­çº§ã€‚</li><li>ä¸­çº§ï¼šä½¿ç”¨<code>react native</code>åšå‡ºä¸€ä¸ªä»¥ä¸Šå·²ç»ä¸Šæ¶çš„<code>ä¸å¤æ‚</code>çš„åº”ç”¨ <code>redux</code>ï¼Œä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ï¼Œå› ä¸ºä½¿ç”¨å®ƒå¹¶ä¸èƒ½è®©ä½ åœ¨å‰æœŸå¿«é€Ÿçš„è¿­ä»£å¼€å‘ï¼Œåœ¨è¿™æ ·çš„é¡¹ç›®ä¸‹ä½¿ç”¨<code>redux</code>å°±å¥½æ¯”<code>å¤§ç‚®æ‰“èšŠå­</code>ï¼Œå‰¯ä½œç”¨å¾ˆå¤§ã€‚ä½†æ˜¯å¯ä»¥å…ˆäº†è§£èµ·æ¥ï¼Œå¹¶å‘ç°å®ƒçš„ä¼˜ç‚¹ã€‚è¿™ç±»ç›¸å¯¹ç®€å•çš„åº”ç”¨ï¼šå½“ç”¨æˆ·è§¦å‘ä¸€ä¸ªåŠ¨ä½œï¼ˆç¨‹åºéœ€è¦<code>setState({xxx:xxx})</code>)çš„æ—¶å€™åº”ç”¨ç¨‹åºçŠ¶æ€æµç¨‹æ˜¯è¿™æ ·çš„ï¼š<br><img src="https://user-gold-cdn.xitu.io/2018/9/27/16618756351af2b4?w=550&amp;h=325&amp;f=gif&amp;s=384959" alt="ç®€å•çš„çŠ¶æ€æµç¨‹"></li></ul><ul><li>é«˜çº§ï¼šä½¿ç”¨<code>react native</code>åšå‡ºä¸€ä¸ªä»¥ä¸Šå·²ç»ä¸Šæ¶çš„<code>å¤æ‚</code>çš„åº”ç”¨(æ¶‰åŠåˆ°å³æ—¶é€šè®¯ã€ç•Œé¢å¸ƒå±€æ¯”è¾ƒå¤æ‚ï¼Œç»„ä»¶åµŒå¥—å¤ªå¤šå±‚æ¬¡ç­‰)ï¼Œè€Œè¿™ç±»å¤æ‚åº”ç”¨ï¼šå½“ç”¨æˆ·è§¦å‘ä¸€ä¸ªåŠ¨ä½œï¼ˆç¨‹åºéœ€è¦<code>setState({xxx:xxx})</code>)çš„æ—¶å€™åº”ç”¨ç¨‹åºçŠ¶æ€æµç¨‹æ˜¯è¿™æ ·çš„ï¼š<br><img src="https://user-gold-cdn.xitu.io/2018/9/27/1661875634f01d51?w=550&amp;h=475&amp;f=gif&amp;s=2170979" alt="å¤æ‚çš„çŠ¶æ€æµç¨‹"></li></ul><p>è¿™ç§çŠ¶æ€å¸¦æ¥çš„åæœï¼Œä¸¤æ–¹é¢åˆ†æï¼š</p><ul><li>æ€§èƒ½ï¼šç¥–çˆ¶å­ç»„ä»¶ä¹‹é—´å¤šä½™çš„çŠ¶æ€ä¼ é€’ï¼Œå¯¼è‡´å®è´µçš„å†…å­˜èµ„æºæµªè´¹ï¼ŒåŒæ—¶ç•Œé¢æ¸²æŸ“çš„é€Ÿåº¦ä¹Ÿä¼šå˜æ…¢ï¼Œè‡ªç„¶ç”¨æˆ·ä½“éªŒå°±å˜å·®äº†ã€‚</li><li>çŠ¶æ€ç®¡ç†ï¼šå½“ç¨‹åºä¸æ–­çš„è¿­ä»£ï¼Œç•Œé¢å¸ƒå±€è¶Šæ¥è¶Šå¤æ‚ï¼Œå¿…ç„¶å°±ä¼šäº§ç”Ÿè®¸å¤šçš„<code>state</code>çŠ¶æ€ï¼Œé‚£ä½ æ˜¯å¦‚ä½•æœ‰æ•ˆçš„ç®¡ç†è¿™äº›çŠ¶æ€ï¼Ÿæ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´UIå¤šæ¬¡æ¸²æŸ“ï¼Ÿæ˜¯å“ªä¸€æ­¥æ“ä½œå¯¼è‡´çš„UIç»„ä»¶çš„å˜åŒ–ï¼Ÿåœ¨æ²¡æœ‰ä½¿ç”¨<code>redux</code>å‰ä½ å¯èƒ½å·²ç»å‘ç°å¯ä»¥ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„<code>shouldComponentUpdate</code>æ¥å‡å°‘å­ç»„ä»¶ä¸­æ²¡å¿…è¦çš„æ¸²æŸ“ï¼Œä½†ç»ˆç©¶è§£å†³ä¸äº†çŠ¶æ€ç®¡ç†å¤æ‚çš„éš¾é¢˜ã€‚<br>å½“ä½ ä½¿ç”¨<code>redux</code>åï¼Œå¤æ‚çš„åº”ç”¨ç¨‹åºçŠ¶æ€æµç¨‹æ˜¯è¿™æ ·çš„ï¼š<br><img src="https://user-gold-cdn.xitu.io/2018/9/27/1661875634d62ba9?w=700&amp;h=475&amp;f=gif&amp;s=2555904" alt="ä½¿ç”¨reduxå"><br>çœ‹å®Œä¸Šé¢å›¾æ–‡åï¼Œæ˜¯å¦æ„Ÿè§‰å¾ˆå¥½ç†è§£æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™è¦ä½¿ç”¨<code>redux</code>å‘¢ï¼Ÿè¿™è¦æ„Ÿè°¢<a href="https://segmentfault.com/u/justjavac" target="_blank" rel="noopener"><strong>@justjavac</strong></a>æ–‡ç« æä¾›çš„åŠ¨å›¾æ”¯æŒã€‚</li></ul><h1 id="redux-for-react-native-å·¥ä½œé€»è¾‘å›¾"><a href="#redux-for-react-native-å·¥ä½œé€»è¾‘å›¾" class="headerlink" title="redux for react native å·¥ä½œé€»è¾‘å›¾"></a>redux for react native å·¥ä½œé€»è¾‘å›¾</h1><p>æ„Ÿè°¢@<a href="https://www.jianshu.com/u/8b645668c3c4" target="_blank" rel="noopener">é»‘æ£®æ—å·¥ä½œå®¤</a>ä½œè€…æä¾›çš„æ¸…æ™°çš„é€»è¾‘å›¾<br><img src="https://user-gold-cdn.xitu.io/2018/9/27/166187566435a4a7?w=800&amp;h=504&amp;f=png&amp;s=57344" alt="æ¸…æ™°é€»è¾‘å›¾"></p><h1 id="reduxå·¥ç¨‹ç»“æ„åˆ†æ"><a href="#reduxå·¥ç¨‹ç»“æ„åˆ†æ" class="headerlink" title="reduxå·¥ç¨‹ç»“æ„åˆ†æ"></a>reduxå·¥ç¨‹ç»“æ„åˆ†æ</h1><p>æˆ‘å¯¹å®˜æ–¹çš„demoå°éƒ¨åˆ†ä½ç½®åšäº†äº›æ”¹é€ å…·ä½“çœ‹ä»£ç åˆ†æï¼š<br><img src="https://user-gold-cdn.xitu.io/2018/9/27/1661875667d5e332?w=600&amp;h=662&amp;f=png&amp;s=99629" alt="image.png"></p><h1 id="åˆ†å·¥æ˜ç»†"><a href="#åˆ†å·¥æ˜ç»†" class="headerlink" title="åˆ†å·¥æ˜ç»†"></a>åˆ†å·¥æ˜ç»†</h1><ul><li><code>js/actions</code><br>æ­¤æ–‡ä»¶å¤¹ä¸‹æ”¾å†…å®¹åšçš„äº‹æƒ…æ˜¯ï¼šå®šä¹‰ç”¨æˆ·è¡Œä¸ºã€‚</li><li><code>js/reducers</code><br>æ­¤æ–‡ä»¶å¤¹ä¸‹æ”¾å†…å®¹åšçš„äº‹æƒ…æ˜¯ï¼šå“åº”ç”¨æˆ·è¡Œä¸ºï¼Œè¿”å›æ”¹å˜åçš„çŠ¶æ€ï¼Œå¹¶å‘é€åˆ° <code>store</code>ã€‚</li><li><code>js/components</code><br>æ­¤æ–‡ä»¶å¤¹ä¸‹æ”¾å†…å®¹åšçš„äº‹æƒ…æ˜¯ï¼šè‡ªå®šä¹‰çš„ç»„ä»¶ã€‚</li><li><code>js/containers</code><br>æ­¤æ–‡ä»¶å¤¹ä¸‹æ”¾å†…å®¹åšçš„äº‹æƒ…æ˜¯ï¼šæŠŠ<code>components</code>æ–‡ä»¶å¤¹ä¸­æ¶‰åŠåˆ°çŠ¶æ€å˜åŒ–çš„ç»„ä»¶è¿›è¡Œç¬¬äºŒæ¬¡å°è£…ã€‚</li><li><code>App.js</code><br>å…¥å£æ–‡ä»¶ï¼ˆstoreåœ¨è¿™é‡Œï¼‰ï¼Œä¸ºä»€ä¹ˆæˆ‘è¦æŠŠstoreå®šä¹‰åœ¨è¿™é‡Œï¼Ÿ å› ä¸ºå®ƒæ˜¯å”¯ä¸€çš„ï¼Œè€Œä¸”å¿…é¡»ä½¿ç”¨<code>react-redux</code>æä¾›çš„<code>Provider</code>ç»„ä»¶åŒ…è£¹å…¥å£çš„å…¶ä»–ç»„ä»¶æ‰èƒ½ä½¿<code>redux</code>ä¸­çš„<code>store</code>ç”Ÿæ•ˆã€‚</li><li><code>global.js</code><br>å­˜æ”¾å…¨å±€å®šä¹‰çš„å˜é‡ã€å¸¸é‡ã€æ–¹æ³•ç­‰ã€‚</li></ul><h1 id="éœ€è¦æ³¨æ„çš„äº‹"><a href="#éœ€è¦æ³¨æ„çš„äº‹" class="headerlink" title="éœ€è¦æ³¨æ„çš„äº‹"></a>éœ€è¦æ³¨æ„çš„äº‹</h1><ul><li>ä¸€ä¸ªå·¥ç¨‹ä¸­ <code>redux</code> çš„ <code>store</code> æ˜¯å”¯ä¸€çš„ï¼Œä¸èƒ½åœ¨å¤šä¸ª <code>store</code>  ã€‚</li><li>ä¿æŒ <code>reducer</code> çº¯å‡€éå¸¸é‡è¦ã€‚æ°¸è¿œä¸è¦åœ¨ <code>reducer</code> é‡Œåšè¿™äº›æ“ä½œï¼š<blockquote><ul><li>ä¿®æ”¹ä¼ å…¥å‚æ•°ï¼›</li><li>æ‰§è¡Œæœ‰å‰¯ä½œç”¨çš„æ“ä½œï¼Œå¦‚ <code>API</code> è¯·æ±‚å’Œè·¯ç”±è·³è½¬ï¼›</li><li>è°ƒç”¨éçº¯å‡½æ•°ï¼Œå¦‚ <code>Date.now()</code> æˆ– <code>Math.random()</code>;</li></ul></blockquote></li><li>ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦<code>...</code>ä»£æ›¿<code>Object.assign()</code>æ‰æ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆã€‚</li><li>ç»„ä»¶åé¦–å­—æ¯è¦å¤§å†™ï¼Œä¹Ÿå°±æ˜¯è¯´<code>components</code>å’Œ<code>containers</code>æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶é¦–å­—æ¯éƒ½è¦å¤§å†™ã€‚</li><li>åº”è¯¥å°½é‡å‡å°‘ä¼ é€’åˆ°<code>action</code> ä¸­çš„æ•°æ®ï¼ˆèƒ½ä¼ å•ä¸ªæ•°æ®å°±ä¸ä¼ å¯¹è±¡ï¼Œèƒ½ä¼ å¯¹è±¡å°±ä¸ä¼ æ•°ç»„ï¼‰<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//good</span><br><span class="line">function todoApp(state = initialState, action) &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case SET_VISIBILITY_FILTER:</span><br><span class="line">      return Object.assign(&#123;&#125;, state, &#123;</span><br><span class="line">        visibilityFilter: action.filter</span><br><span class="line">      &#125;)</span><br><span class="line">    default:</span><br><span class="line">      return state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//best</span><br><span class="line">function todoApp(state = initialState, action) &#123;</span><br><span class="line">  switch (action.type) &#123;</span><br><span class="line">    case SET_VISIBILITY_FILTER:</span><br><span class="line">      return &#123; ...state, visibilityFilter: action.filter &#125;</span><br><span class="line">    default:</span><br><span class="line">      return state</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>#ä»£ç è¯¦è§£<br><code>js/actions/types.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//æ·»åŠ åˆ—è¡¨æ•°æ®</span><br><span class="line">export const ADD_TODO = &apos;ADD_TODO&apos;;</span><br><span class="line">//ç­›é€‰</span><br><span class="line">export const SET_VISIBILITY_FILTER = &apos;SET_VISIBILITY_FILTER&apos;;</span><br><span class="line">//æ–‡å­—æ·»åŠ ï¼å–æ¶ˆä¸­åˆ’çº¿</span><br><span class="line">export const TOGGLE_TODO = &apos;TOGGLE_TODO&apos;;</span><br></pre></td></tr></table></figure></p><h3 id="é‡Šï¼š"><a href="#é‡Šï¼š" class="headerlink" title="é‡Šï¼š"></a>é‡Šï¼š</h3><h4 id="actionå®šä¹‰"><a href="#actionå®šä¹‰" class="headerlink" title="actionå®šä¹‰"></a>actionå®šä¹‰</h4><p>ä¸ºä»€ä¹ˆæˆ‘è¦æŠŠç”¨æˆ·çš„<code>action</code>(è¡Œä¸º)å®šä¹‰å•ç‹¬æŠ½å‡ºæ¥å†™ä¸€ä¸ª<code>type.js</code>ï¼Ÿ</p><ul><li>æ–¹ä¾¿çŠ¶æ€ç®¡ç†ã€‚</li><li>å¤ç”¨æ€§ã€‚</li></ul><hr><p><code>js/actions/index.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import  &#123;</span><br><span class="line">    ADD_TODO,</span><br><span class="line">    SET_VISIBILITY_FILTER,</span><br><span class="line">    TOGGLE_TODO,</span><br><span class="line">&#125; from &apos;./types&apos;</span><br><span class="line">let nextTodoId = 0;</span><br><span class="line"></span><br><span class="line">export const addTodo = text =&gt; (&#123;</span><br><span class="line">    type: ADD_TODO,</span><br><span class="line">    id: nextTodoId++,</span><br><span class="line">    text</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export const setVisibilityFilter = (filter) =&gt; (&#123;</span><br><span class="line">    type: SET_VISIBILITY_FILTER,</span><br><span class="line">    filter</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export const toggleTodo = id =&gt; (&#123;</span><br><span class="line">    type: TOGGLE_TODO,</span><br><span class="line">    id</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><h3 id="é‡Šï¼š-1"><a href="#é‡Šï¼š-1" class="headerlink" title="é‡Šï¼š"></a>é‡Šï¼š</h3><h4 id="Action-åˆ›å»ºå‡½æ•°"><a href="#Action-åˆ›å»ºå‡½æ•°" class="headerlink" title="Action åˆ›å»ºå‡½æ•°"></a>Action åˆ›å»ºå‡½æ•°</h4><p>Action åˆ›å»ºå‡½æ•° å°±æ˜¯ç”Ÿæˆ action çš„æ–¹æ³•ã€‚â€œactionâ€ å’Œ â€œaction åˆ›å»ºå‡½æ•°â€ è¿™ä¸¤ä¸ªæ¦‚å¿µå¾ˆå®¹æ˜“æ··åœ¨ä¸€èµ·ï¼Œä½¿ç”¨æ—¶æœ€å¥½æ³¨æ„åŒºåˆ†ã€‚</p><p>åœ¨ Redux ä¸­çš„ action åˆ›å»ºå‡½æ•°åªæ˜¯ç®€å•çš„è¿”å›ä¸€ä¸ª action:</p><hr><p><code>js/reducers/todos.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">import  &#123;</span><br><span class="line">    ADD_TODO,</span><br><span class="line">    TOGGLE_TODO,</span><br><span class="line">&#125; from &apos;../actions/types&apos;</span><br><span class="line"></span><br><span class="line">const todos = (state = [], action) =&gt; &#123;</span><br><span class="line">    let &#123;id, text, type&#125; = action;</span><br><span class="line">    switch (type) &#123;</span><br><span class="line">        case ADD_TODO:</span><br><span class="line">            return [</span><br><span class="line">                ...state,</span><br><span class="line">                &#123;</span><br><span class="line">                    id: id,</span><br><span class="line">                    text: text,</span><br><span class="line">                    completed: false</span><br><span class="line">                &#125;</span><br><span class="line">            ];</span><br><span class="line">        case TOGGLE_TODO:</span><br><span class="line">            return state.map(todo =&gt; (todo.id === id) ? &#123;...todo, completed: !todo.completed&#125; : todo);</span><br><span class="line">        default:</span><br><span class="line">            return state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export  default  todos;</span><br></pre></td></tr></table></figure></p><p><code>js/reducers/visibilityFilter.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import &#123; SET_VISIBILITY_FILTER &#125; from &apos;../actions/types&apos;</span><br><span class="line">import &#123; visibilityFilters &#125; from &apos;../global&apos;</span><br><span class="line"></span><br><span class="line">const &#123; SHOW_ALL &#125; = visibilityFilters;</span><br><span class="line">const visibilityFilter = (state = SHOW_ALL, action) =&gt; &#123;</span><br><span class="line">    let &#123;type, filter&#125; = action;</span><br><span class="line">    switch (type)&#123;</span><br><span class="line">        case SET_VISIBILITY_FILTER:</span><br><span class="line">            return filter;</span><br><span class="line">        default:</span><br><span class="line">            return state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">export default  visibilityFilter;</span><br></pre></td></tr></table></figure></p><h3 id="é‡Šï¼š-2"><a href="#é‡Šï¼š-2" class="headerlink" title="é‡Šï¼š"></a>é‡Šï¼š</h3><h4 id="reducer-å°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œæ¥æ”¶æ—§çš„-state-å’Œ-actionï¼Œè¿”å›æ–°çš„-stateï¼ˆä¸Šé¢ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥çœ‹ç€ä¸¤ä¸ªreducerï¼‰ã€‚"><a href="#reducer-å°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œæ¥æ”¶æ—§çš„-state-å’Œ-actionï¼Œè¿”å›æ–°çš„-stateï¼ˆä¸Šé¢ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥çœ‹ç€ä¸¤ä¸ªreducerï¼‰ã€‚" class="headerlink" title="reducer å°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œæ¥æ”¶æ—§çš„ state å’Œ actionï¼Œè¿”å›æ–°çš„ stateï¼ˆä¸Šé¢ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥çœ‹ç€ä¸¤ä¸ªreducerï¼‰ã€‚"></a>reducer å°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œæ¥æ”¶æ—§çš„ state å’Œ actionï¼Œè¿”å›æ–°çš„ stateï¼ˆä¸Šé¢ä¸¤ä¸ªæ–‡ä»¶å¯ä»¥çœ‹ç€ä¸¤ä¸ªreducerï¼‰ã€‚</h4><h3 id="æ³¨æ„ï¼š"><a href="#æ³¨æ„ï¼š" class="headerlink" title="æ³¨æ„ï¼š"></a>æ³¨æ„ï¼š</h3><ul><li><code>Redux</code> é¦–æ¬¡æ‰§è¡Œæ—¶ï¼Œ<code>state</code> ä¸º <code>undefined</code>ï¼Œæ­¤æ—¶éœ€è¦è®¾ç½®è¿”å›åº”ç”¨çš„åˆå§‹ <code>state</code>ã€‚</li><li>æ¯ä¸ª <code>reducer</code> åªè´Ÿè´£ç®¡ç†å…¨å±€ <code>state</code> ä¸­å®ƒè´Ÿè´£çš„ä¸€éƒ¨åˆ†ã€‚æ¯ä¸ª <code>reducer</code> çš„ <code>state</code> å‚æ•°éƒ½ä¸åŒï¼Œåˆ†åˆ«å¯¹åº”å®ƒç®¡ç†çš„é‚£éƒ¨åˆ† <code>state</code> æ•°æ®ã€‚</li></ul><hr><p><code>js/reducers/index.js</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import &#123; combineReducers &#125; from &apos;redux&apos;</span><br><span class="line">import todos from &apos;./todos&apos;</span><br><span class="line">import visibilityFilter from &apos;./visibilityFilter&apos;</span><br><span class="line"></span><br><span class="line">export default combineReducers(&#123;</span><br><span class="line">    todos,</span><br><span class="line">    visibilityFilter</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="é‡Šï¼š-3"><a href="#é‡Šï¼š-3" class="headerlink" title="é‡Šï¼š"></a>é‡Šï¼š</h3><h4 id="combineReducers-æ‰€åšçš„åªæ˜¯ç”Ÿæˆä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥è°ƒç”¨ä½ çš„ä¸€ç³»åˆ—-reducerï¼Œæ¯ä¸ª-reducer-æ ¹æ®å®ƒä»¬çš„-key-æ¥ç­›é€‰å‡º-state-ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®å¹¶å¤„ç†ï¼Œç„¶åè¿™ä¸ªç”Ÿæˆçš„å‡½æ•°å†å°†æ‰€æœ‰-reducer-çš„ç»“æœåˆå¹¶æˆä¸€ä¸ªå¤§çš„å¯¹è±¡ã€‚"><a href="#combineReducers-æ‰€åšçš„åªæ˜¯ç”Ÿæˆä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥è°ƒç”¨ä½ çš„ä¸€ç³»åˆ—-reducerï¼Œæ¯ä¸ª-reducer-æ ¹æ®å®ƒä»¬çš„-key-æ¥ç­›é€‰å‡º-state-ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®å¹¶å¤„ç†ï¼Œç„¶åè¿™ä¸ªç”Ÿæˆçš„å‡½æ•°å†å°†æ‰€æœ‰-reducer-çš„ç»“æœåˆå¹¶æˆä¸€ä¸ªå¤§çš„å¯¹è±¡ã€‚" class="headerlink" title="combineReducers()æ‰€åšçš„åªæ˜¯ç”Ÿæˆä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥è°ƒç”¨ä½ çš„ä¸€ç³»åˆ— reducerï¼Œæ¯ä¸ª reducer æ ¹æ®å®ƒä»¬çš„ key æ¥ç­›é€‰å‡º state ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®å¹¶å¤„ç†ï¼Œç„¶åè¿™ä¸ªç”Ÿæˆçš„å‡½æ•°å†å°†æ‰€æœ‰ reducer çš„ç»“æœåˆå¹¶æˆä¸€ä¸ªå¤§çš„å¯¹è±¡ã€‚"></a><code>combineReducers()</code>æ‰€åšçš„åªæ˜¯ç”Ÿæˆä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ¥è°ƒç”¨ä½ çš„ä¸€ç³»åˆ— reducerï¼Œæ¯ä¸ª reducer <strong>æ ¹æ®å®ƒä»¬çš„ key æ¥ç­›é€‰å‡º state ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®å¹¶å¤„ç†</strong>ï¼Œç„¶åè¿™ä¸ªç”Ÿæˆçš„å‡½æ•°å†å°†æ‰€æœ‰ reducer çš„ç»“æœåˆå¹¶æˆä¸€ä¸ªå¤§çš„å¯¹è±¡ã€‚</h4><p>è¡¨é¢ä¸Šçœ‹ä¸Šå»<code>combineReducers()</code>çš„ä½œç”¨å°±æ˜¯æŠŠå¤šä¸ª<code>reducer</code>åˆæˆä¸€ä¸ªçš„<code>reducer</code>ã€‚</p><hr><p><code>js/components/Todo.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;</span><br><span class="line">import &#123;</span><br><span class="line">    Text,</span><br><span class="line">    TouchableOpacity</span><br><span class="line">&#125; from &apos;react-native&apos;</span><br><span class="line">import PropTypes from &apos;prop-types&apos;</span><br><span class="line"></span><br><span class="line">export default class Todo extends Component &#123;</span><br><span class="line">    static propTypes = &#123;</span><br><span class="line">        onClick: PropTypes.func.isRequired,</span><br><span class="line">        completed: PropTypes.bool.isRequired,</span><br><span class="line">        text: PropTypes.string.isRequired</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    render()&#123;</span><br><span class="line">        let &#123; onClick, completed, text &#125; = this.props;</span><br><span class="line">        return (</span><br><span class="line">            &lt;TouchableOpacity</span><br><span class="line">                style=&#123;&#123;</span><br><span class="line">                    flexDirection: &apos;row&apos;,</span><br><span class="line">                    flex: 1,</span><br><span class="line">                    height: 50,</span><br><span class="line">                    alignItems: &apos;center&apos;,</span><br><span class="line">                    justifyContent: &apos;center&apos;,</span><br><span class="line">                    backgroundColor: &apos;#cccccc&apos;,</span><br><span class="line">                    marginTop: 10</span><br><span class="line">                &#125;&#125;</span><br><span class="line">                onPress=&#123;onClick&#125;&gt;</span><br><span class="line">                &lt;Text style=&#123;&#123; textDecorationLine: completed ? &apos;line-through&apos; : &apos;none&apos;&#125;&#125;&gt;&#123;text&#125;&lt;/Text&gt;</span><br><span class="line">            &lt;/TouchableOpacity&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>js/components/TodoList.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;</span><br><span class="line">import PropTypes from &apos;prop-types&apos;</span><br><span class="line">import &#123;</span><br><span class="line">    FlatList</span><br><span class="line">&#125; from &apos;react-native&apos;</span><br><span class="line">import Todo from &apos;./Todo&apos;</span><br><span class="line"></span><br><span class="line">export default class TodoList extends Component &#123;</span><br><span class="line">    static propTypes = &#123;</span><br><span class="line">        todos: PropTypes.arrayOf(</span><br><span class="line">            PropTypes.shape(&#123;</span><br><span class="line">                id: PropTypes.number.isRequired,</span><br><span class="line">                completed: PropTypes.bool.isRequired,</span><br><span class="line">                text: PropTypes.string.isRequired</span><br><span class="line">            &#125;).isRequired</span><br><span class="line">        ).isRequired,</span><br><span class="line">        toggleTodo: PropTypes.func.isRequired</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    _renderItem = (data) =&gt; &#123;</span><br><span class="line">       let dataItem = data.item;</span><br><span class="line">       let &#123; id &#125; = dataItem;</span><br><span class="line">       let &#123; toggleTodo &#125; = this.props;</span><br><span class="line">        return (</span><br><span class="line">            &lt;Todo</span><br><span class="line">                &#123;...dataItem&#125;</span><br><span class="line">                onClick=&#123;() =&gt; toggleTodo(id)&#125;</span><br><span class="line">            /&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        let &#123; todos &#125; = this.props;</span><br><span class="line">        return (</span><br><span class="line">            &lt;FlatList</span><br><span class="line">                data=&#123;todos&#125;</span><br><span class="line">                keyExtractor=&#123;(item)=&gt;item.id.toString()&#125;</span><br><span class="line">                renderItem=&#123;this._renderItem&#125;</span><br><span class="line">            /&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>js/components/Link.js.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;</span><br><span class="line">import PropTypes from &apos;prop-types&apos;</span><br><span class="line">import &#123;</span><br><span class="line">    TouchableOpacity,</span><br><span class="line">    Text</span><br><span class="line">&#125; from &apos;react-native&apos;</span><br><span class="line"></span><br><span class="line">export default class Link extends Component &#123;</span><br><span class="line">    static propTypes = &#123;</span><br><span class="line">        active: PropTypes.bool.isRequired,</span><br><span class="line">        filter: PropTypes.string.isRequired,</span><br><span class="line">        onClick: PropTypes.func.isRequired</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        let &#123; active,  filter, onClick &#125; = this.props;</span><br><span class="line">        return (</span><br><span class="line">           &lt;TouchableOpacity</span><br><span class="line">               style=&#123;&#123;</span><br><span class="line">                   marginLeft: 4,</span><br><span class="line">                   height: 40,</span><br><span class="line">                   flex:1,</span><br><span class="line">                   borderWidth: 1,</span><br><span class="line">                   borderColor: &apos;#ccc&apos;,</span><br><span class="line">                   alignItems: &apos;center&apos;,</span><br><span class="line">                   justifyContent:&apos;center&apos;</span><br><span class="line">               &#125;&#125;</span><br><span class="line">               onPress=&#123;onClick&#125;</span><br><span class="line">           &gt;</span><br><span class="line">               &lt;Text style=&#123;&#123;fontSize: 10, color: active ? &apos;black&apos; : &apos;#cccccc&apos;&#125;&#125;&gt;&#123;filter&#125;&lt;/Text&gt;</span><br><span class="line">           &lt;/TouchableOpacity&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><code>js/components/Filters.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;</span><br><span class="line">import &#123;</span><br><span class="line">    View,</span><br><span class="line">&#125; from &apos;react-native&apos;</span><br><span class="line">import FilterLink from &apos;../containers/FilterLink&apos;</span><br><span class="line">import &#123; visibilityFilters &#125; from &apos;../global&apos;</span><br><span class="line"></span><br><span class="line">const &#123; SHOW_ALL, SHOW_COMPLETED, SHOW_ACTIVE  &#125; = visibilityFilters;</span><br><span class="line"></span><br><span class="line">export default  class Filters extends Component &#123;</span><br><span class="line"></span><br><span class="line">    render()&#123;</span><br><span class="line">        return(</span><br><span class="line">            &lt;View style=&#123;&#123; flexDirection: &apos;row&apos;, marginTop: 20&#125;&#125;&gt;</span><br><span class="line">                &lt;FilterLink filter=&#123;SHOW_ALL&#125; /&gt;</span><br><span class="line">                &lt;FilterLink filter=&#123;SHOW_COMPLETED&#125; /&gt;</span><br><span class="line">                &lt;FilterLink filter=&#123;SHOW_ACTIVE&#125; /&gt;</span><br><span class="line">            &lt;/View&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><img src="https://user-gold-cdn.xitu.io/2018/9/27/166187566cc9bb2d?w=800&amp;h=361&amp;f=png&amp;s=34551" alt="image.png"></p><h3 id="é‡Šï¼š-4"><a href="#é‡Šï¼š-4" class="headerlink" title="é‡Šï¼š"></a>é‡Šï¼š</h3><h4 id="ä»¥ä¸Šå››ä¸ªæ–‡ä»¶æ˜¯è‡ªå®šä¹‰çš„å››ä¸ªå±•ç¤ºç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶åªå®šä¹‰å¤–è§‚å¹¶ä¸å…³å¿ƒæ•°æ®æ¥æºå’Œå¦‚ä½•æ”¹å˜ã€‚ä¼ å…¥ä»€ä¹ˆå°±æ¸²æŸ“ä»€ä¹ˆã€‚å¦‚æœä½ æŠŠä»£ç ä»-Redux-è¿ç§»åˆ°åˆ«çš„æ¶æ„ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥ä¸åšä»»ä½•æ”¹åŠ¨ç›´æ¥ä½¿ç”¨ã€‚å®ƒä»¬å¹¶ä¸ä¾èµ–äº-Reduxã€‚"><a href="#ä»¥ä¸Šå››ä¸ªæ–‡ä»¶æ˜¯è‡ªå®šä¹‰çš„å››ä¸ªå±•ç¤ºç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶åªå®šä¹‰å¤–è§‚å¹¶ä¸å…³å¿ƒæ•°æ®æ¥æºå’Œå¦‚ä½•æ”¹å˜ã€‚ä¼ å…¥ä»€ä¹ˆå°±æ¸²æŸ“ä»€ä¹ˆã€‚å¦‚æœä½ æŠŠä»£ç ä»-Redux-è¿ç§»åˆ°åˆ«çš„æ¶æ„ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥ä¸åšä»»ä½•æ”¹åŠ¨ç›´æ¥ä½¿ç”¨ã€‚å®ƒä»¬å¹¶ä¸ä¾èµ–äº-Reduxã€‚" class="headerlink" title="ä»¥ä¸Šå››ä¸ªæ–‡ä»¶æ˜¯è‡ªå®šä¹‰çš„å››ä¸ªå±•ç¤ºç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶åªå®šä¹‰å¤–è§‚å¹¶ä¸å…³å¿ƒæ•°æ®æ¥æºå’Œå¦‚ä½•æ”¹å˜ã€‚ä¼ å…¥ä»€ä¹ˆå°±æ¸²æŸ“ä»€ä¹ˆã€‚å¦‚æœä½ æŠŠä»£ç ä» Redux è¿ç§»åˆ°åˆ«çš„æ¶æ„ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥ä¸åšä»»ä½•æ”¹åŠ¨ç›´æ¥ä½¿ç”¨ã€‚å®ƒä»¬å¹¶ä¸ä¾èµ–äº Reduxã€‚"></a>ä»¥ä¸Šå››ä¸ªæ–‡ä»¶æ˜¯è‡ªå®šä¹‰çš„å››ä¸ªå±•ç¤ºç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶åªå®šä¹‰å¤–è§‚å¹¶ä¸å…³å¿ƒæ•°æ®æ¥æºå’Œå¦‚ä½•æ”¹å˜ã€‚ä¼ å…¥ä»€ä¹ˆå°±æ¸²æŸ“ä»€ä¹ˆã€‚å¦‚æœä½ æŠŠä»£ç ä» Redux è¿ç§»åˆ°åˆ«çš„æ¶æ„ï¼Œè¿™äº›ç»„ä»¶å¯ä»¥ä¸åšä»»ä½•æ”¹åŠ¨ç›´æ¥ä½¿ç”¨ã€‚å®ƒä»¬å¹¶ä¸ä¾èµ–äº Reduxã€‚</h4><hr><p><code>js/containers/AddTodo.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;</span><br><span class="line">import &#123;</span><br><span class="line">    View,</span><br><span class="line">    TextInput,</span><br><span class="line">    Button,</span><br><span class="line">&#125; from &apos;react-native&apos;</span><br><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;</span><br><span class="line">import &#123; addTodo &#125; from &apos;../actions&apos;</span><br><span class="line"></span><br><span class="line">class AddTodo extends Component &#123;</span><br><span class="line">    constructor(props)&#123;</span><br><span class="line">        super(props);</span><br><span class="line">        this.inputValue = &apos;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render()&#123;</span><br><span class="line">        let &#123; dispatch &#125; = this.props;</span><br><span class="line">        return (</span><br><span class="line">            &lt;View style=&#123;&#123;flexDirection: &apos;row&apos;&#125;&#125;&gt;</span><br><span class="line">                &lt;TextInput</span><br><span class="line">                    style=&#123;&#123;flex:1, borderWidth: 1, borderColor: &apos;#cccccc&apos;, textAlign: &apos;center&apos;&#125;&#125;</span><br><span class="line">                    onChangeText=&#123;text =&gt; this.inputValue = text&#125;</span><br><span class="line">                /&gt;</span><br><span class="line">                &lt;Button title=&quot;Add Todo&quot; onPress=&#123;() =&gt; dispatch(addTodo(this.inputValue))&#125;/&gt;</span><br><span class="line">            &lt;/View&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">export default connect()(AddTodo)</span><br></pre></td></tr></table></figure></p><p><code>js/containers/FilterLink.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;</span><br><span class="line">import &#123; setVisibilityFilter &#125; from &apos;../actions&apos;</span><br><span class="line">import Link from &apos;../components/Link&apos;</span><br><span class="line"></span><br><span class="line">const mapStateToProps = (state, ownProps) =&gt; (&#123;</span><br><span class="line">    active: ownProps.filter === state.visibilityFilter,</span><br><span class="line">    filterText: ownProps.filter</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const mapDispatchToProps = (dispatch, ownProps) =&gt; (&#123;</span><br><span class="line">    onClick: () =&gt; dispatch(setVisibilityFilter(ownProps.filter))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default connect(</span><br><span class="line">    mapStateToProps,</span><br><span class="line">    mapDispatchToProps,</span><br><span class="line">)(Link)</span><br></pre></td></tr></table></figure></p><p><code>js/containers/VisibleTodoList.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import &#123; connect &#125; from &apos;react-redux&apos;</span><br><span class="line">import &#123; toggleTodo &#125; from &apos;../actions&apos;</span><br><span class="line">import TodoList from &apos;../components/TodoList&apos;</span><br><span class="line">import &#123; visibilityFilters &#125; from &apos;../global&apos;</span><br><span class="line"></span><br><span class="line">const &#123; SHOW_ALL, SHOW_COMPLETED, SHOW_ACTIVE &#125; = visibilityFilters;</span><br><span class="line"></span><br><span class="line">const getVisibleTodos = (todos, filter) =&gt; &#123;</span><br><span class="line">    switch (filter) &#123;</span><br><span class="line">        case SHOW_COMPLETED:</span><br><span class="line">            return todos.filter(t =&gt; t.completed);</span><br><span class="line">        case SHOW_ACTIVE:</span><br><span class="line">            return todos.filter(t =&gt; !t.completed);</span><br><span class="line">        case SHOW_ALL:</span><br><span class="line">            return todos;</span><br><span class="line">        default:</span><br><span class="line">            throw new Error(&apos;Unknown filter: &apos; + filter)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const mapStateToProps = state =&gt; (&#123;</span><br><span class="line">    todos: getVisibleTodos(state.todos, state.visibilityFilter)</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const mapDispatchToProps = dispatch =&gt; (&#123;</span><br><span class="line">    toggleTodo: id =&gt; dispatch(toggleTodo(id))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">export default connect(</span><br><span class="line">    mapStateToProps,</span><br><span class="line">    mapDispatchToProps,</span><br><span class="line">)(TodoList)</span><br></pre></td></tr></table></figure></p><h3 id="é‡Šï¼š-5"><a href="#é‡Šï¼š-5" class="headerlink" title="é‡Šï¼š"></a>é‡Šï¼š</h3><h4 id="ä»¥ä¸Šä¸‰ä¸ªæ˜¯å®¹å™¨ç»„ä»¶ï¼Œä½œç”¨æ˜¯æŠŠå±•ç¤ºç»„ä»¶è¿æ¥åˆ°-Reduxã€‚"><a href="#ä»¥ä¸Šä¸‰ä¸ªæ˜¯å®¹å™¨ç»„ä»¶ï¼Œä½œç”¨æ˜¯æŠŠå±•ç¤ºç»„ä»¶è¿æ¥åˆ°-Reduxã€‚" class="headerlink" title="ä»¥ä¸Šä¸‰ä¸ªæ˜¯å®¹å™¨ç»„ä»¶ï¼Œä½œç”¨æ˜¯æŠŠå±•ç¤ºç»„ä»¶è¿æ¥åˆ° Reduxã€‚"></a>ä»¥ä¸Šä¸‰ä¸ªæ˜¯å®¹å™¨ç»„ä»¶ï¼Œä½œç”¨æ˜¯æŠŠå±•ç¤ºç»„ä»¶è¿æ¥åˆ° Reduxã€‚</h4><p>æœ‰æ—¶å¾ˆéš¾åˆ†æ¸…åˆ°åº•è¯¥ä½¿ç”¨å®¹å™¨ç»„ä»¶è¿˜æ˜¯å±•ç¤ºç»„ä»¶ã€‚å¦‚è¿™ä¸ªå°çš„ç»„ä»¶ï¼š</p><blockquote><ul><li><code>AddTodo.js</code> å«æœ‰â€œAddâ€æŒ‰é’® å’Œ è¾“å…¥æ¡†</li></ul></blockquote><p>æŠ€æœ¯ä¸Šè®²å¯ä»¥æŠŠå®ƒåˆ†æˆä¸¤ä¸ªç»„ä»¶ï¼Œä½†ä¸€å¼€å§‹å°±è¿™ä¹ˆåšæœ‰ç‚¹æ—©ã€‚åœ¨ä¸€äº›éå¸¸å°çš„ç»„ä»¶é‡Œæ··ç”¨å®¹å™¨å’Œå±•ç¤ºæ˜¯å¯ä»¥çš„ã€‚å½“ä¸šåŠ¡å˜å¤æ‚åï¼Œå¦‚ä½•æ‹†åˆ†å°±å¾ˆæ˜æ˜¾äº†ã€‚æ‰€ä»¥ç°åœ¨å°±ä½¿ç”¨æ··åˆå‹çš„å§ã€‚</p><p>ä¸Šé¢å‡ºç°äº†ä½¿ç”¨<code>react-redux</code>çš„<code>connect()</code>æ–¹æ³•æ¥æŠŠå±•ç¤ºç»„ä»¶å’Œå®¹å™¨ç»„ä»¶å…³è”åœ¨ä¸€èµ·ï¼Œè¿™ä¸ªæ–¹æ³•åšäº†æ€§èƒ½ä¼˜åŒ–æ¥é¿å…å¾ˆå¤šä¸å¿…è¦çš„é‡å¤æ¸²æŸ“ã€‚ï¼ˆè¿™æ ·ä½ å°±ä¸å¿…ä¸ºäº†æ€§èƒ½è€Œæ‰‹åŠ¨å®ç° <a href="https://doc.react-china.org/docs/optimizing-performance.html" target="_blank" rel="noopener">React æ€§èƒ½ä¼˜åŒ–å»ºè®®</a> ä¸­çš„ <code>shouldComponentUpdate</code> æ–¹æ³•ã€‚ï¼‰</p><p>ä½¿ç”¨ <code>connect()</code> å‰ï¼Œéœ€è¦å…ˆå®šä¹‰ <code>mapStateToProps</code> è¿™ä¸ªå‡½æ•°æ¥æŒ‡å®šå¦‚ä½•æŠŠå½“å‰ <code>Redux store state</code> æ˜ å°„åˆ°å±•ç¤ºç»„ä»¶çš„ <code>props</code> ä¸­ã€‚ä¾‹å¦‚ï¼Œ<code>VisibleTodoList</code> éœ€è¦è®¡ç®—ä¼ åˆ° <code>TodoList</code> ä¸­çš„ <code>todos</code>ï¼Œæ‰€ä»¥å®šä¹‰äº†æ ¹æ® <code>state.visibilityFilter</code> æ¥è¿‡æ»¤ <code>state.todos</code> çš„æ–¹æ³•ï¼Œå¹¶åœ¨ <code>mapStateToProps</code> ä¸­ä½¿ç”¨ã€‚</p><p>é™¤äº†è¯»å– <code>state</code>ï¼Œå®¹å™¨ç»„ä»¶è¿˜èƒ½åˆ†å‘ <code>action</code>ã€‚ç±»ä¼¼çš„æ–¹å¼ï¼Œå¯ä»¥å®šä¹‰ <code>mapDispatchToProps()</code> æ–¹æ³•æ¥æ”¶ <a href="https://cn.redux.js.org/docs/api/Store.html#dispatch" target="_blank" rel="noopener"><code>dispatch()</code></a> æ–¹æ³•å¹¶è¿”å›æœŸæœ›æ³¨å…¥åˆ°å±•ç¤ºç»„ä»¶çš„ props ä¸­çš„å›è°ƒæ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¸Œæœ› <code>VisibleTodoList</code> å‘ <code>TodoList</code> ç»„ä»¶ä¸­æ³¨å…¥ä¸€ä¸ªå« <code>onTodoClick</code> çš„ props ï¼Œè¿˜å¸Œæœ› <code>onTodoClick</code>èƒ½åˆ†å‘ <code>TOGGLE_TODO</code> è¿™ä¸ª <code>action</code>ã€‚<br>æœ€åï¼Œä½¿ç”¨ <code>connect()</code> åˆ›å»º <code>VisibleTodoList</code>ï¼Œå¹¶ä¼ å…¥è¿™ä¸¤ä¸ªå‡½æ•°ã€‚</p><hr><p><code>js/components/Group.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;</span><br><span class="line">import &#123;</span><br><span class="line">    View</span><br><span class="line">&#125; from &apos;react-native&apos;</span><br><span class="line">import AddTodo from &apos;../containers/AddTodo&apos;</span><br><span class="line">import Filters from &apos;../components/Filters&apos;</span><br><span class="line">import VisibleTodoList from &apos;../containers/VisibleTodoList&apos;</span><br><span class="line"></span><br><span class="line">export default class Group extends Component &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        return (</span><br><span class="line">            &lt;View style=&#123;&#123;paddingHorizontal: 20, paddingVertical: 44&#125;&#125;&gt;</span><br><span class="line">                &lt;AddTodo/&gt;</span><br><span class="line">                &lt;Filters/&gt;</span><br><span class="line">                &lt;VisibleTodoList/&gt;</span><br><span class="line">            &lt;/View&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="é‡Šï¼š-6"><a href="#é‡Šï¼š-6" class="headerlink" title="é‡Šï¼š"></a>é‡Šï¼š</h3><h4 id="Group-js-æ˜¯æŠŠæ‰€æœ‰çš„å…³è”åçš„ç»„ä»¶ä¸²èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„ç•Œé¢ã€‚"><a href="#Group-js-æ˜¯æŠŠæ‰€æœ‰çš„å…³è”åçš„ç»„ä»¶ä¸²èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„ç•Œé¢ã€‚" class="headerlink" title="Group.js æ˜¯æŠŠæ‰€æœ‰çš„å…³è”åçš„ç»„ä»¶ä¸²èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„ç•Œé¢ã€‚"></a>Group.js æ˜¯æŠŠæ‰€æœ‰çš„å…³è”åçš„ç»„ä»¶ä¸²èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„ç•Œé¢ã€‚</h4><hr><p><code>App.js</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import React, &#123; Component &#125; from &apos;react&apos;</span><br><span class="line">import &#123; createStore &#125; from &apos;redux&apos;</span><br><span class="line">import &#123; Provider &#125; from &apos;react-redux&apos;</span><br><span class="line">import Group from &apos;./js/components/Group&apos;</span><br><span class="line">import rootReducer from &apos;./js/reducers&apos;</span><br><span class="line"></span><br><span class="line">export default class App extends Component &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        const store = createStore(rootReducer);</span><br><span class="line">        return (</span><br><span class="line">            &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">                &lt;Group /&gt;</span><br><span class="line">            &lt;/Provider&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="é‡Šï¼š-7"><a href="#é‡Šï¼š-7" class="headerlink" title="é‡Šï¼š"></a>é‡Šï¼š</h3><h4 id="å…¥å£æ–‡ä»¶ä¼ å…¥-Store"><a href="#å…¥å£æ–‡ä»¶ä¼ å…¥-Store" class="headerlink" title="å…¥å£æ–‡ä»¶ä¼ å…¥ Store"></a>å…¥å£æ–‡ä»¶ä¼ å…¥ Store</h4><ul><li>åˆ›å»º<code>store</code>ä¼ å…¥<code>reducers</code>ã€‚</li><li>ä½¿ç”¨<code>Provider</code>ç»„ä»¶åŒ…è£¹   <code>Group</code>ç»„ä»¶, <code>store</code>ä½œä¸ºå±æ€§ä¼ å…¥<code>Provider</code>ã€‚</li></ul><hr><p>è¿›è¡Œåˆ°è¿™ä¸€æ­¥ï¼Œä»£ç åˆ†æå®Œæ¯•ã€‚æœ¬æ¬¡å†™ä½œåˆ°æ­¤ç»“æŸã€‚æˆ‘ç›¸ä¿¡å¤§å®¶å¦‚æœä»”ç»†çœ‹å®Œçš„è¯ï¼Œå¤šå¤šå°‘å°‘ä¼šæœ‰äº›æ”¶è·å§ï¼Œå¦‚æœdemoçœ‹ä¸å¤ªæ‡‚ï¼Œé‚£å°±è·Ÿç€ä»£ç åˆ†æçš„æ€è·¯å¤šæ•²å‡ éä»£ç ï¼Œä¹Ÿå°±ç†è§£äº†ï¼Œæœ‰ç©ºæˆ‘ä¼šç»§ç»­æ›´æ–°æœªå®Œæˆçš„å†…å®¹ã€‚</p><h1 id="å½©è›‹"><a href="#å½©è›‹" class="headerlink" title="å½©è›‹"></a>å½©è›‹</h1><p>é™„ä¸Š github demo <a href="https://github.com/giantss/ReduxForReactNativeDemo" target="_blank" rel="noopener">ReduxForReactNativeDemo</a> å¥½ä½¿çš„è¯ï¼Œåˆ«å¿˜äº†ç»™å‡ºå®è´µçš„â¤ï¸â­ï¸ï¼Œæ²¡æœ‰æ¯”è¿™ä¸ªæ›´èƒ½é¼“èˆäººå¿ƒçš„äº† ğŸ˜‚ã€‚æœ€åæ¬¢è¿ğŸ‘æŒ‡å‡ºé”™è¯¯æˆ–è€…å‘å¸ƒè‡ªå·±çš„è§è§£æ¢è®¨ï¼Œå…±å‹‰ã€‚ğŸ¤</p><h3 id="å¾…æ›´æ–°å†…å®¹"><a href="#å¾…æ›´æ–°å†…å®¹" class="headerlink" title="å¾…æ›´æ–°å†…å®¹"></a>å¾…æ›´æ–°å†…å®¹</h3><ul><li>Middlewareçš„ä½¿ç”¨ã€‚</li><li>é…åˆreact-navigationä½¿ç”¨ã€‚</li><li>â€¦â€¦</li></ul><p>hello <a href="https://giantss.github.io/blog/2018/09/27/Redux-for-react-native-æŒ‡å—-æŒç»­æ›´æ–°/">https://giantss.github.io/blog/2018/09/27/Redux-for-react-native-æŒ‡å—-æŒç»­æ›´æ–°/</a> bye</p>]]></content>
      
      
      
        <tags>
            
            <tag> react native </tag>
            
            <tag> Redux </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
